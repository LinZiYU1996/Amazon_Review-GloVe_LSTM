# Classifying Amazon reviews with word embedding technique(Glove)+LSTM and with Bag-of-words and lemmatization.

## Dataset and objective
The dataset I used is available at http://jmcauley.ucsd.edu/data/amazon/. I used review data for the electronics category. The ratings range from 1 to 5 integers, so I changed the ratings of 1, 2, and 3 into 0(LOW) and the rest into 1(HIGH). Now the task is a binary classification problem.

The objective is to claffisify each review's rating by its review text.


## GloVe + LSTM
GloVe is an unsupervised learning algorithm for transforming human languages to word vector representations. I used the pre-trained word vectors trained with 6B tokens with 100 dimensions. Details about the GloVe model is available at https://nlp.stanford.edu/projects/glove/.

After applying GloVe, I used LSTM as a classifier, which is a variation of RNN(Recurrent Neural Network) which defies vanishing gradient problem. If you want to understand LSTM more, Colah's blog is a very popular source. ( http://colah.github.io/posts/2015-08-Understanding-LSTMs/ ) I implemented my model with Keras, one of the popular deep learning frameworks built on top of TensorFlow framework.

The test accuracy is _86.19 %_.

The LSTM model has structure as follows:

Layer (type)                | Output Shape             | Param #   
--------------------------- | ------------------------ | -------
input1 (InputLayer)         | (None, 100)              |  0        
embedding1 (Embedding)		| (None, 100, 100)		   | 1000000
bidirectional1 (Bidirection | (None, 100, 100)         |  60400     
globalmaxpooling1d1 (Glob	| (None, 100)              |  0         
dense1 (Dense)              | (None, 50)               |  5050      
dropout1 (Dropout)          | (None, 50)               |  0         
dense2 (Dense)              | (None, 1)                |  51        

Total params: 1,065,501
Trainable params: 1,065,501
Non-trainable params: 0

For its detail results, please refer to the file 'run_gpu1.out'.


## Bag-of-words + Lemmatization + Traditional ML models
As a comparison, I also used bag-of-words technique, which is a very simple model of counting the occurrence of each word in the dictionary from review text. Here, I used the top n number of frequent words as the dictionary. For a text data preprocessing, I conducted lemmatization(stemming), removing stopwords, and tokenization. After lemmatization, the dictionary includes words of original form for example 'bad', 'computer', and 'want' instead of conjugated words such as 'worse', 'computers', and 'wanted'. This might deal with sparsity problems of the feature matrix.

Here is the summary of the results of test accuracies with different dictionary size.

Dictionary Size | Naive Bayes | LightGBM
--------------- | ----------- | --------
50              | 64.80 %     | 66.56 %
100             | 66.45 %     | 69.08 %
200             | 70.22 %     | 73.86 %
400             | 73.02 %     | 77.33 %
600             | 74.14 %     | 78.77 %
1000            | 75.71 %     | 80.64 %
1500            | 76.06 %     | 81.18 %
2000            | 76.55 %     | 81.63 %

*LightGBM wasn't fully tuned, so the performance is assumed to be improved.*

## Conclusions and Limitations
In conclusion, manual feature extraction in bag-of-words model works quite better than I expected. It is assumed becuase of plenty of data I used. So, data is king! However, the approach has limitations in that you always need to set a right size of dictionary based on the size of your dataset and your trained dictionary would be less effective for other dataset. It took too long (approximately 24 hours) just to run the Glove + LSTM model, but it performed better with simple implementation.

In the GloVe + LSTM model, its tokenization was done before train/test dataset split. Its data is large enough so it wouldn't compromise to the performance of the model I believe. However, theoretically it should be done after test/train split. It also seems to suffer from overfitting a bit considering its evaluation losses and accuracies, so the capacity of the model needs to be adjusted. I ran the code on a supercomputing cluster with GPU at the University of Pittsburgh, the running time could be shorter with multi GPU use. In addition, the performance could be better with larger pretrained models (i.e. larger dimension and token size).

In the bag-of-words model, lemmatization didn't help the performance at all when the dictionary size was small (at 100). I assume it's because the dictionaries (the feature matrices) are too limited to capture the sentiment of the review texts. As the dictionary size increases, the performance improved significantly while the execution time didn't suffer much. Since the dataset is large, it becomes so important to find a right size of dictionary. NLTK wasn't very efficient to process this large data, so other NLP libraries such as 'Spacy' could work better.

## Appendix

Dictionary words (with the size of 1000)

['ability', 'able', 'absolutely', 'ac', 'access', 'accessory', 'across', 'actual', 'actually', 'adapter', 'add', 'addition', 'additional', 'address', 'adjust', 'adjustment', 'advertise', 'advertised', 'ago', 'air', 'allow', 'almost', 'along', 'already', 'also', 'although', 'always', 'amaze', 'amazing', 'amazon', 'amount', 'amp', 'android', 'angle', 'annoy', 'another', 'answer', 'antenna', 'anyone', 'anything', 'anyway', 'anywhere', 'apart', 'app', 'apparently', 'appear', 'apple', 'application', 'apply', 'apps', 'area', 'arm', 'around', 'arrive', 'ask', 'assume', 'asus', 'attach', 'attempt', 'audio', 'auto', 'automatically', 'available', 'average', 'avoid', 'away', 'awesome', 'back', 'background', 'backpack', 'backup', 'bad', 'bag', 'band', 'bar', 'barely', 'base', 'basic', 'basically', 'bass', 'battery', 'beat', 'become', 'begin', 'behind', 'believe', 'belkin', 'best', 'big', 'bit', 'black', 'block', 'blow', 'blue', 'bluetooth', 'board', 'body', 'book', 'boot', 'bose', 'bother', 'bottom', 'bought', 'box', 'bracket', 'brand', 'break', 'bright', 'bring', 'bubble', 'buck', 'bud', 'build', 'bulky', 'burn', 'business', 'button', 'buy', 'ca', 'cable', 'call', 'camcorder', 'camera', 'canon', 'cap', 'capability', 'capacity', 'car', 'card', 'care', 'careful', 'carry', 'case', 'cause', 'cd', 'cell', 'center', 'certain', 'certainly', 'chance', 'change', 'channel', 'charge', 'charger', 'cheap', 'check', 'choice', 'choose', 'claim', 'class', 'clean', 'clear', 'clearly', 'click', 'clip', 'close', 'color', 'come', 'comfortable', 'comment', 'compact', 'company', 'compare', 'comparison', 'compartment', 'compatible', 'complain', 'complaint', 'complete', 'completely', 'component', 'computer', 'con', 'concern', 'condition', 'configuration', 'configure', 'connect', 'connection', 'connector', 'consider', 'constantly', 'construction', 'contact', 'content', 'continue', 'control', 'controller', 'convenient', 'cool', 'cooler', 'copy', 'cord', 'corner', 'correct', 'correctly', 'cost', 'could', 'couple', 'course', 'cover', 'cpu', 'create', 'current', 'currently', 'customer', 'cut', 'damage', 'dark', 'data', 'day', 'dead', 'deal', 'decent', 'decide', 'default', 'defective', 'definitely', 'degree', 'deliver', 'dell', 'depend', 'description', 'design', 'desk', 'desktop', 'despite', 'detail', 'device', 'die', 'difference', 'different', 'difficult', 'digital', 'direct', 'direction', 'directly', 'disappoint', 'disappointed', 'disc', 'disconnect', 'disk', 'display', 'distance', 'dock', 'dollar', 'dont', 'door', 'double', 'download', 'drive', 'driver', 'drop', 'dslr', 'dual', 'due', 'durable', 'dust', 'dvd', 'ear', 'earbuds', 'early', 'earphone', 'easily', 'easy', 'edge', 'edit', 'effect', 'either', 'electronics', 'else', 'email', 'enclosure', 'end', 'enjoy', 'enough', 'enter', 'entire', 'equipment', 'error', 'especially', 'etc', 'ethernet', 'even', 'eventually', 'ever', 'every', 'everyone', 'everything', 'exactly', 'example', 'excellent', 'except', 'expect', 'expensive', 'experience', 'extend', 'extension', 'external', 'extra', 'extremely', 'eye', 'face', 'fact', 'factory', 'fail', 'fairly', 'fall', 'family', 'fan', 'fantastic', 'far', 'fast', 'faster', 'fault', 'favorite', 'feature', 'feel', 'felt', 'figure', 'file', 'fill', 'film', 'filter', 'finally', 'find', 'fine', 'finger', 'finish', 'fire', 'firmware', 'first', 'fit', 'five', 'fix', 'flash', 'flat', 'flaw', 'flawlessly', 'flimsy', 'flip', 'floor', 'fm', 'focus', 'fold', 'follow', 'foot', 'force', 'forget', 'form', 'format', 'forward', 'four', 'frame', 'free', 'frequency', 'friend', 'front', 'full', 'fully', 'fun', 'function', 'functionality', 'future', 'galaxy', 'game', 'garmin', 'gb', 'generation', 'get', 'gift', 'give', 'glad', 'glass', 'go', 'good', 'google', 'gps', 'graphic', 'great', 'green', 'grip', 'guess', 'guy', 'half', 'hand', 'handle', 'handy', 'hang', 'happen', 'happy', 'hard', 'hardware', 'hd', 'hdmi', 'hdtv', 'head', 'headphone', 'headset', 'hear', 'heat', 'heavy', 'help', 'high', 'highly', 'hit', 'hold', 'hole', 'home', 'hook', 'hop', 'hope', 'horrible', 'hot', 'hour', 'house', 'however', 'hp', 'hub', 'huge', 'idea', 'image', 'immediately', 'important', 'impossible', 'impressed', 'improve', 'improvement', 'inch', 'include', 'included', 'increase', 'inexpensive', 'information', 'input', 'insert', 'inside', 'instal', 'install', 'installation', 'instead', 'instruction', 'intend', 'interface', 'internal', 'internet', 'ip', 'ipad', 'iphone', 'ipod', 'issue', 'item', 'jack', 'job', 'junk', 'keep', 'key', 'keyboard', 'kid', 'kind', 'kindle', 'kit', 'know', 'label', 'lack', 'laptop', 'large', 'last', 'late', 'later', 'lcd', 'lead', 'learn', 'least', 'leather', 'leave', 'led', 'left', 'length', 'lens', 'less', 'let', 'level', 'lg', 'life', 'light', 'like', 'likely', 'limit', 'limited', 'line', 'link', 'linksys', 'list', 'listen', 'little', 'live', 'load', 'local', 'location', 'lock', 'logitech', 'long', 'longer', 'look', 'loose', 'lose', 'lot', 'loud', 'love', 'low', 'luck', 'mac', 'macbook', 'machine', 'main', 'major', 'make', 'manual', 'manufacturer', 'many', 'map', 'mark', 'market', 'match', 'material', 'matter', 'may', 'maybe', 'mean', 'medium', 'memory', 'mention', 'menu', 'message', 'metal', 'mic', 'micro', 'microphone', 'microsoft', 'middle', 'might', 'mile', 'mind', 'mine', 'mini', 'minor', 'minute', 'miss', 'mode', 'model', 'modem', 'money', 'monitor', 'month', 'mostly', 'motherboard', 'mount', 'mouse', 'move', 'movie', 'much', 'multiple', 'music', 'must', 'na', 'name', 'near', 'nearly', 'need', 'negative', 'netflix', 'netgear', 'network', 'never', 'new', 'next', 'nexus', 'nice', 'nicely', 'night', 'nikon', 'noise', 'none', 'normal', 'note', 'nothing', 'notice', 'number', 'obviously', 'offer', 'office', 'often', 'ok', 'okay', 'old', 'one', 'online', 'onto', 'open', 'operate', 'opinion', 'optical', 'option', 'order', 'original', 'others', 'otherwise', 'outlet', 'output', 'outside', 'overall', 'pack', 'package', 'packaging', 'pad', 'page', 'pain', 'pair', 'panasonic', 'panel', 'paper', 'part', 'particular', 'past', 'pay', 'pc', 'pen', 'people', 'per', 'perfect', 'perfectly', 'perform', 'performance', 'perhaps', 'period', 'person', 'phone', 'photo', 'pick', 'picture', 'piece', 'pin', 'place', 'plan', 'plastic', 'play', 'player', 'please', 'pleased', 'plenty', 'plug', 'plus', 'pocket', 'point', 'poor', 'pop', 'port', 'portable', 'position', 'positive', 'possible', 'post', 'power', 'prefer', 'press', 'pretty', 'previous', 'price', 'prime', 'print', 'printer', 'pro', 'probably', 'problem', 'process', 'processor', 'produce', 'product', 'professional', 'program', 'projector', 'properly', 'protect', 'protection', 'protector', 'provide', 'pull', 'purchase', 'purpose', 'push', 'put', 'quality', 'question', 'quick', 'quickly', 'quiet', 'quite', 'radio', 'ram', 'range', 'rate', 'rather', 'rating', 'reach', 'read', 'reader', 'ready', 'real', 'realize', 'really', 'reason', 'reasonable', 'reboot', 'receive', 'receiver', 'recently', 'reception', 'recognize', 'recommend', 'record', 'recording', 'red', 'refund', 'regular', 'relatively', 'release', 'reliable', 'remember', 'remote', 'remove', 'repair', 'replace', 'replacement', 'report', 'require', 'research', 'reset', 'resolution', 'response', 'rest', 'result', 'return', 'review', 'reviewer', 'right', 'ring', 'road', 'roku', 'room', 'route', 'router', 'rubber', 'run', 'sale', 'samsung', 'sandisk', 'sata', 'save', 'saw', 'say', 'scratch', 'screen', 'screw', 'scroll', 'sd', 'seagate', 'search', 'second', 'secure', 'security', 'see', 'seem', 'select', 'sell', 'seller', 'send', 'sensor', 'separate', 'series', 'server', 'service', 'set', 'setting', 'setup', 'several', 'shape', 'share', 'sharp', 'ship', 'shipping', 'shoot', 'short', 'shot', 'show', 'shut', 'shutter', 'side', 'signal', 'similar', 'simple', 'simply', 'since', 'single', 'sit', 'site', 'situation', 'size', 'sleep', 'sleeve', 'slide', 'slightly', 'slip', 'slot', 'slow', 'small', 'smart', 'smooth', 'snap', 'soft', 'software', 'solid', 'solution', 'solve', 'someone', 'something', 'sometimes', 'somewhat', 'son', 'song', 'sony', 'soon', 'sort', 'sound', 'source', 'space', 'speak', 'speaker', 'special', 'speed', 'spend', 'spot', 'ssd', 'stand', 'standard', 'star', 'start', 'state', 'static', 'station', 'stay', 'step', 'stereo', 'stick', 'still', 'stock', 'stop', 'storage', 'store', 'straight', 'strap', 'stream', 'strong', 'stuff', 'sturdy', 'style', 'stylus', 'sub', 'suggest', 'super', 'supply', 'support', 'suppose', 'sure', 'surface', 'surprise', 'surround', 'switch', 'sync', 'system', 'tab', 'tablet', 'take', 'talk', 'tape', 'tech', 'technology', 'tell', 'tend', 'term', 'terrible', 'test', 'thanks', 'thick', 'thin', 'thing', 'think', 'third', 'though', 'three', 'throw', 'tight', 'time', 'tiny', 'tip', 'today', 'together', 'tool', 'top', 'toshiba', 'total', 'totally', 'touch', 'track', 'transfer', 'transmitter', 'travel', 'trip', 'tripod', 'trouble', 'true', 'try', 'turn', 'tv', 'twice', 'two', 'type', 'u', 'understand', 'unfortunately', 'unit', 'unless', 'unlike', 'unplug', 'update', 'upgrade', 'usb', 'use', 'useful', 'useless', 'user', 'usually', 'value', 'various', 'version', 'via', 'video', 'view', 'voice', 'volume', 'wait', 'walk', 'wall', 'want', 'warranty', 'waste', 'watch', 'water', 'way', 'wd', 'weak', 'wear', 'web', 'website', 'week', 'weight', 'well', 'whatever', 'wheel', 'whether', 'white', 'whole', 'wide', 'wife', 'wifi', 'window', 'wire', 'wireless', 'wish', 'within', 'without', 'wo', 'wonder', 'wonderful', 'word', 'work', 'world', 'worry', 'worth', 'would', 'write', 'wrong', 'x', 'xbox', 'xp', 'year', 'yes', 'yet', 'youtube', 'zoom']
